
<!doctype html>
<html>
  <head>
    <title>JS1k, 1k webgl demo submission [ID]</title>
    <meta charset="utf-8" />
    <style>
      html, body { margin: 0; padding: 0; border: 0; }
      #c { display: block; } /* kill scrollbars from hell */
    </style>
  </head>
  <body>
    <canvas id="c"></canvas>
    <script>
      var a = document.getElementsByTagName('canvas')[0];
      var b = document.body;
      // unprefix some popular vendor prefixed things (but stick to their original name)
      var AudioContext =
        window.AudioContext ||
        window.webkitAudioContext;
      var requestAnimationFrame =
        window.requestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function(f){ setTimeout(f, 1000/30); };
      // stretch canvas to screen size (once, wont onresize!)
      a.style.width = (a.width = innerWidth) + 'px';
      a.style.height = (a.height = innerHeight) + 'px';

      var g = (function () {
        try {
          var o = { antialias: true, stencil: true };
          var gl = c.getContext('webgl', o) || c.getContext('experimental-webgl', o);

          // keep in scope, must not be garbage collected
          __glExts =
            [ 'OES_texture_float', 'OES_texture_float_linear', 'OES_standard_derivatives',
              'EXT_texture_filter_anisotropic', 'MOZ_EXT_texture_filter_anisotropic', 'WEBKIT_EXT_texture_filter_anisotropic',
              'WEBGL_compressed_texture_s3tc', 'MOZ_WEBGL_compressed_texture_s3tc', 'WEBKIT_WEBGL_compressed_texture_s3tc'
            ].map(function (ext) {
              return gl.getExtension(ext);
            });

        } catch (e) {
          document.body.innerHTML = 'WebGL not supported.';
          throw e;
        }

        return gl;
      })();
    </script>
    <script>
      if (!g) throw there_was_a_webgl_error;
// start of submission //
with(g){b.style.background="#000";for(k in g)g[k.match(/^..|[A-Z]|1f$/g).join("")]=g[k];for(vi(0,S=0,s=256,a.style.cssText=a.width=a.height=s),p=crP(t=2);t;coS(S),atS(p,S))shS(S=crS(35634-t),--t?"precision lowp float;uniform float T;void main(void){vec2 a=gl_FragCoord.xy;vec2 b=a/256.;vec3 c=vec3(b.xy*2.-1.,.9);vec3 d=c;d.z-=15.5;vec3 e=vec3(.0);float f;float g;for(float h=0.;h<20.;h+=1.){float i=T/4.+.01*d.y;float j=cos(i);float k=sin(i);mat2 l=mat2(j,-k,k,j);vec3 m=abs(1.-mod(vec3(l*mix(d.xz,d.xy,abs(sin(T/5.))),d.y),2.));f=max(length(vec2(length(m.xz)-(sin(T)/2.+.5),m.y))-.4,length(d)-10.5);g=h;if(abs(f)<.005) break;d+=c*f;}e=vec3(g/40.)*(1.-length(b-.5))*1.4;e+=fract(sin(dot(b,vec2(12.9,78.2)))*43758.5)*.15;if(mod(a.x+a.y,6.)>2.) e*=.9;gl_FragColor=vec4(vec3(e),1.);}":"attribute vec4 p;void main(){gl_Position=p;}");D=function(){requestAnimationFrame(D),drA(4,un1f(geUL(p,"T"),t+=.01),3)},D(veAP(enVAA(biB(k=34962,crB())),2,5126,liP(p),usP(p),buD(k,new Float32Array([1,1,1,-3,-3,1]),k+82)))}
// end of submission //
  </script>
  </body>
</html>
